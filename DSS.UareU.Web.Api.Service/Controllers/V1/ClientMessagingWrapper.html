<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>auth2factor fingerprint client messaging wrapper</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>

        function receiveMessage(event) {
            // Do we trust the sender of this message?
            if (event.origin !== "http://localhost:8081")
                return;

            // { name, args }
            if (event.data.name === 'device_info') {
                axios.get('/api/v1/device_info')
                  .then(function (response) {
                      event.source.window.postMessage(response.data, event.origin);
                  })
                  .catch(function (error) {
                      console.log(error);
                  });
            }
        }

        window.addEventListener("message", receiveMessage, false);
    </script>
</head>

<body>

</body>
</html>